{
  "hash": "18a88126d19a04c93349744402851330",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Anaomaly Detection adobeanalytisr'\nauthor: 'Ben R Woodard'\ndate: '2021-03-02'\ndraft: false\nslug: []\ncategories: ['adobeanalyticsr']\ntags:\n  - R\nimage: \"/images/anomaly_detection.png\"\nauthors: ['benrwoodard']\n---\n\n\n\nWhen I first started working with the new Adobe Analytics API 2.0 I wanted to tap into the powerful anomaly detection that was built into Analysis Workspace.  According to Adobe \"Anomaly Detection provides a statistical method to determine how a given metric has changed in relation to previous data.\" <!--more-->\n\nThe hope was always that the Anomaly Detection would allow analysts to separate “true signals” from “noise” but that's been pretty difficult in the Analysis Workspace UI.  It has definitly helped 'identify potential factors that contributed to those signals or anomalies' but it has fallen short in actually providing the final solution.  That's because anomalies are complex and require context to prove whether the event can be repeated or should just be explained. \n\nThe hope of anomaly detection has always the same. Adobe's documentation expresses it very well.\n\n> ...it lets you identify which statistical fluctuations matter and which don’t. You can then identify the root cause of a true anomaly. Furthermore, you can get reliable metric (KPI) forecasts.\n\nUnfortunately the reality is that using this tool of statistical analysis can prove to be a lot of wasted time and effort.  With that being said, Adobe's anomaly detection does provide a very powerful opportunity if used correctly.\n\nThe current application of Analysis Workspace’s anomaly detection algorithm includes\n\n1. Support for hourly, weekly, and monthly granularity, in addition to the existing daily granularity.\n2. Awareness of seasonality (such as “Black Friday”) and holidays.\n\n### So what does this look like in adobeanalyticsr?\n\nThe new adobeanaltyicsr function for anomaly detection,  `aw_anomaly_report()`, is designed to facilitate the principle of \"speed to analysis\" while fostering better reporting opportunities.  \n\nThe default function call will return a basic data frame of 7 different columns. \n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\nIf you request more than one metric it will return a row for each metrica at the granularity level you requested in the function.\n\nFor instance, the following function will return this:\n\n```\naw_anomaly_report(date_range = c(\"2020-12-01\", \"2021-03-01\"),\n                  metrics = c('visits','visitors'))\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngt::gt(head(aw_anomaly_report(date_range = c(\"2024-12-01\", \"2024-12-31\"),\n                  metrics = c('visits','visitors'),\n                  rsid = 'lumalucaslidemo'), 10))\n```\n:::\n\n\nNotice that each row includes the data, expected, upper bound, and lower bounds calculated for you already.  It also includes whether or not the data crossed one of those bounds and was determined to be an anomaly.\n\nFor those looking to get to the 'raw' data, this should be just what you need to get going.  But there are many times that all you are wanting to do is visualize the data or just show the dates that an anomaly was detected.  This was my main use case so I created an argument that will help you quickly view the results.  \n\nAdding the argument `quickView = TRUE` to the function call will return a list of 3 items. It will also split these results by the different metrics that were requested, if there are more than 1 in the request.  \n\nThe following example shows the same function call as above but it includes the `quickView = TRUE` argument. The list includes:\n\n1. Data = The raw data just like in the default function but split up by metric if you have requested more than one.\n2. Anoms = The filtered view of the data showing only those rows (by metric) where 'anomalyDetection = TRUE'.\n3. Viz = A line graph produced using ggplot which includes the error bar, points on the timeline where an anomay was detected, and finally the data shown in a line expanding over the period requested in the date range.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- aw_anomaly_report(date_range = c(\"2020-12-01\", \"2021-03-01\"),\n                  metrics = c('visits','visitors'),\n                  quickView = TRUE, \n                  rsid = 'lumalucaslidemo')\ndf[[1]]$data\ndf[[1]]$anom\n```\n:::\n\n\n<img src = 'unnamed-chunk-2-1.png' width = '100%'>\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf[[2]]$data\ndf[[2]]$anoms\n```\n:::\n\n\n<img src = 'unnamed-chunk-2-2.png' width = '100%'>\n\nFor more on Anomaly Detection in Analysis Workspace check out this video.\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/krXyQCjXoeU\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n\nI'm always looking for new ways to serve up the anomaly detection data. If you have an idea, make sure to [submit an issue](https://github.com/benrwoodard/adobeanalyticsr/issues) for me to work on with you.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}